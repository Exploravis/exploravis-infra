kind: role
version: v7
metadata:
  name: admin-impersonator-bot
spec:
  options:
    max_session_ttl: 1h
  allow:
    join:
      github:
        allow:
          - repository: "{{ github_infra_repo }}"
            workflow: "{{ github_infra_repo_workflows }}"
    rules:
      - resources: ['*']
        verbs: ['*']

    # Use Kubernetes groups instead of direct resource mapping
    kubernetes_groups: ["system:masters"]
    kubernetes_labels:
      '*': '*'

    # Remove the kubernetes_resources section - let Teleport handle the mapping
  deny: {}
