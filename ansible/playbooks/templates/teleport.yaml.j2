version: v3
teleport:
  nodename: "{{ inventory_hostname }}"
  data_dir: {{ teleport_data_dir }}
  join_params:
    token_name: ""
    method: token
  log:
    output: stderr
    severity: INFO
    format:
      output: text
  ca_pin: ""
  diag_addr: ""

auth_service:
  enabled: yes
  listen_addr: 0.0.0.0:3025
  cluster_name: {{ teleport_host | regex_replace(':.*$', '') }}
  proxy_listener_mode: multiplex

ssh_service:
  enabled: yes

proxy_service:
  enabled: yes
  web_listen_addr: 0.0.0.0:443
  public_addr: {{ teleport_host }}
  acme:
    enabled: "yes"
    email: mahdi.svt5@gmail.com

kubernetes_service:
  enabled: yes
  listen_addr: 0.0.0.0:3027 
  kubeconfig_file: /etc/rancher/k3s/k3s.yaml
